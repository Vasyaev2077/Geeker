{% extends "base/base_app.html" %}
{% load i18n static %}

{% block title %}{% trans "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è" %}{% endblock %}

{% block extra_head %}
{{ block.super }}
<link rel="stylesheet" href="https://unpkg.com/cropperjs@1.6.2/dist/cropper.min.css">
{% endblock %}

{% block extra_js %}
{{ block.super }}
<script src="https://unpkg.com/cropperjs@1.6.2/dist/cropper.min.js"></script>
<script src="{% static 'js/profile_avatar.js' %}"></script>
{% endblock %}

{% block app_content %}
<div class="profile-edit-panel">
  <div class="profile-edit-header">
    <h2>{% trans "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è" %}</h2>
  </div>
  <div class="profile-edit-body">
    <div class="profile-edit-avatar-block">
      <div class="profile-avatar profile-avatar-large profile-avatar-editable">
        {% if form.instance.avatar %}
          <img id="avatar-preview-img" src="{{ form.instance.avatar.url }}" alt="{{ form.instance.display_name }}">
          <span id="avatar-preview-initial" class="profile-avatar-initial" style="display:none">{{ request.user.username|first|upper }}</span>
        {% else %}
          <img id="avatar-preview-img" src="" alt="{{ form.instance.display_name }}" style="display:none">
          <span id="avatar-preview-initial" class="profile-avatar-initial">{{ request.user.username|first|upper }}</span>
        {% endif %}
        <button type="button" id="avatar-edit-btn" class="avatar-edit-btn" aria-label="{% trans '–ò–∑–º–µ–Ω–∏—Ç—å –∞–≤–∞—Ç–∞—Ä' %}">
          ‚úé
        </button>
        <span class="avatar-edit-hint">{% trans "–ò–∑–º–µ–Ω–∏—Ç—å" %}</span>
      </div>
      <div class="profile-edit-name">
        <strong>{{ form.instance.display_name }}</strong>
      </div>
    </div>
    <form method="post" enctype="multipart/form-data" class="profile-edit-form">
      {% csrf_token %}
      <div class="profile-hidden-file-input" style="display:none">
        {{ form.avatar }}
      </div>
      {% if form.avatar.errors %}
        <div class="field-error">{{ form.avatar.errors }}</div>
      {% endif %}
      <div class="profile-edit-row">
        <div class="profile-edit-icon">üë§</div>
        <div class="profile-edit-field">
          <label for="{{ form.display_name.id_for_label }}">{% trans "–ò–º—è" %}</label>
          {{ form.display_name }}
        </div>
      </div>
      <div class="profile-edit-row">
        <div class="profile-edit-icon">üìù</div>
        <div class="profile-edit-field">
          <label for="{{ form.bio.id_for_label }}">Bio</label>
          {{ form.bio }}
          <div class="char-counter" id="bio-counter" aria-hidden="true">200</div>
        </div>
      </div>
      <div class="profile-edit-row">
        <div class="profile-edit-icon">üåê</div>
        <div class="profile-edit-field">
          <label for="{{ form.language.id_for_label }}">{% trans "–Ø–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞" %}</label>
          {{ form.language }}
        </div>
      </div>
      <div class="profile-edit-row">
        <div class="profile-edit-icon">‚è∞</div>
        <div class="profile-edit-field">
          <label for="{{ form.timezone.id_for_label }}">{% trans "–ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å" %}</label>
          {{ form.timezone }}
        </div>
      </div>
      <div class="profile-edit-actions">
        <button type="submit" class="btn btn-primary">{% trans "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å" %}</button>
      </div>
    </form>
  </div>
</div>

<div id="avatar-crop-modal" class="modal" hidden aria-hidden="true">
  <div class="modal-backdrop" data-avatar-close></div>
  <div class="modal-dialog" role="dialog" aria-modal="true" aria-labelledby="avatar-crop-title">
    <div class="modal-header">
      <h3 id="avatar-crop-title">{% trans "–í—ã–±–µ—Ä–∏—Ç–µ –æ–±–ª–∞—Å—Ç—å –∞–≤–∞—Ç–∞—Ä–∞" %}</h3>
      <button type="button" class="modal-close" data-avatar-close aria-label="{% trans '–ó–∞–∫—Ä—ã—Ç—å' %}">√ó</button>
    </div>
    <div class="modal-body">
      <div class="avatar-crop-workspace">
        <div class="avatar-crop-canvas-wrap">
          <img id="avatar-crop-img" class="avatar-crop-img" alt="">
        </div>
        <div class="avatar-crop-previews">
          <div class="avatar-crop-preview avatar-crop-preview-lg"></div>
          <div class="avatar-crop-preview avatar-crop-preview-md"></div>
          <div class="avatar-crop-preview avatar-crop-preview-sm"></div>
        </div>
      </div>
      <input id="avatar-crop-zoom" type="range" min="0" max="100" value="0" aria-label="{% trans '–ú–∞—Å—à—Ç–∞–±' %}" hidden>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn" data-avatar-close>{% trans "–û—Ç–º–µ–Ω–∞" %}</button>
      <button type="button" class="btn btn-primary" id="avatar-crop-save">{% trans "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å" %}</button>
    </div>
  </div>
</div>
{% endblock %}







