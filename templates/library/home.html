{% extends "base/base_app.html" %}
<<<<<<< HEAD
{% load i18n static %}
{% trans "–¢–æ—á–Ω–æ —É–¥–∞–ª–∏—Ç—å —Ä–∞–∑–¥–µ–ª? –ü–æ—Ç–æ–º –±—É–¥–µ—Ç –µ—â—ë –æ–¥–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ." as confirm_delete_section %}
{% trans "–¢–æ—á–Ω–æ —É–¥–∞–ª–∏—Ç—å –ø—Ä–µ–¥–º–µ—Ç? –ü–æ—Ç–æ–º –±—É–¥–µ—Ç –µ—â—ë –æ–¥–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ." as confirm_delete_item %}
=======
{% load i18n %}
>>>>>>> c3b89d27ec563af11f9e50443796471accc02753

{% block title %}{% trans "–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞" %}{% endblock %}

{% block app_content %}
<form method="get" class="library-filters">
  <div class="page-header">
<<<<<<< HEAD
    <div class="library-header-title">{% trans "–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞" %}</div>
=======
    <div></div>
>>>>>>> c3b89d27ec563af11f9e50443796471accc02753
    <div class="page-header-actions">
      <button type="button" class="search-icon-button" id="library-search-toggle">
        üîç
      </button>
      <div class="library-search-input-row" id="library-search-row">
        <button type="button" class="search-back" id="library-search-back">‚Üê</button>
        <input
          type="search"
          name="q"
          value="{{ query }}"
          class="search-input"
<<<<<<< HEAD
          placeholder="{% trans '–ü–æ–∏—Å–∫ –ø–æ —Ä–∞–∑–¥–µ–ª–∞–º –∏ –ø—Ä–µ–¥–º–µ—Ç–∞–º' %}"
        >
        <button type="button" class="search-clear" id="library-search-clear">‚úï</button>
      </div>
      <a href="{% url 'library:section_create' %}" class="btn btn-pill btn-pill-primary">
        {% trans "+ –°–æ–∑–¥–∞—Ç—å —Ä–∞–∑–¥–µ–ª" %}
      </a>
      <select name="order" class="order-select search-extra" style="display:inline-block;">
=======
          placeholder="{% trans '–ü–æ–∏—Å–∫ –ø–æ –∫–æ–ª–ª–µ–∫—Ü–∏–∏' %}"
        >
        <button type="button" class="search-clear" id="library-search-clear">‚úï</button>
        <label class="advanced-toggle">
          <input type="checkbox" name="advanced" {% if advanced %}checked{% endif %}>
          {% trans "–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π" %}
        </label>
      </div>
      <select name="order" class="order-select search-extra">
>>>>>>> c3b89d27ec563af11f9e50443796471accc02753
        <option value="recent" {% if current_order == 'recent' %}selected{% endif %}>{% trans "–ù–µ–¥–∞–≤–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ" %}</option>
        <option value="oldest" {% if current_order == 'oldest' %}selected{% endif %}>{% trans "–î–∞–≤–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ" %}</option>
        <option value="az" {% if current_order == 'az' %}selected{% endif %}>{% trans "–û—Ç –ê –¥–æ –Ø" %}</option>
        <option value="za" {% if current_order == 'za' %}selected{% endif %}>{% trans "–û—Ç –Ø –¥–æ –ê" %}</option>
      </select>
    </div>
  </div>

<<<<<<< HEAD
=======
  <div class="advanced-panel {% if not advanced %}advanced-hidden{% endif %}">
    <label>
      <input type="checkbox" name="search_in_description" {% if request.GET.search_in_description == 'on' %}checked{% endif %}>
      {% trans "–ò—Å–∫–∞—Ç—å —Ç–æ–ª—å–∫–æ –≤ –æ–ø–∏—Å–∞–Ω–∏–∏" %}
    </label>
  </div>

>>>>>>> c3b89d27ec563af11f9e50443796471accc02753
  <div class="pill-filters">
    {% for section in sections %}
      <label class="pill">
        <input
          type="checkbox"
          name="sections"
          value="{{ section.id }}"
          {% if section.id in selected_sections %}checked{% endif %}
        >
        {{ section.name }}
      </label>
    {% empty %}
<<<<<<< HEAD
      {# no sections: keep UI clean (no text) #}
=======
      <span>{% trans "–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç —Ä–∞–∑–¥–µ–ª–æ–≤. –°–æ–∑–¥–∞–π—Ç–µ –∏—Ö –≤ –∞–¥–º–∏–Ω–∫–µ." %}</span>
>>>>>>> c3b89d27ec563af11f9e50443796471accc02753
    {% endfor %}
  </div>

</form>

<<<<<<< HEAD
<div class="section-grid" style="margin-top:0.9rem;">
  {% for section in sections %}
    <div class="section-card">
      <div class="post-menu section-card-menu">
        <button type="button" class="post-menu-btn" data-menu-btn aria-label="Menu">‚Ä¶</button>
        <div class="post-menu-dropdown" data-menu-dropdown hidden>
          <a class="post-menu-item" href="{% url 'library:section_edit' section.pk %}">{% trans "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å" %}</a>
          <a class="post-menu-item post-menu-danger"
             href="{% url 'library:section_delete' section.pk %}"
             onclick="return confirm(&quot;{{ confirm_delete_section|escapejs }}&quot;)">
            {% trans "–£–¥–∞–ª–∏—Ç—å" %}
          </a>
        </div>
      </div>
      <a class="section-card-link" href="{% url 'library:section_detail' section.pk %}">
        <div class="section-cover">
          {% if section.cover %}
            <img src="{{ section.cover.url }}" alt="{{ section.name }}">
          {% else %}
            <div class="section-cover-placeholder"></div>
          {% endif %}
        </div>
        <div class="section-card-body">
          <div class="section-card-title">{{ section.name }}</div>
          <div class="section-card-desc">{{ section.description|default_if_none:"" }}</div>
        </div>
      </a>
    </div>
  {% empty %}
    <div style="margin-top:1rem; color:#6b7280;">
      {% trans "–°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—ã–π —Ä–∞–∑–¥–µ–ª, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞—Ç—å." %}
    </div>
  {% endfor %}
</div>

{% if expanded_sections %}
  <div style="margin-top:1.2rem;">
    {% for block in expanded_sections %}
      <section class="section-expanded">
        <div class="page-header">
          <h2 style="margin:0;">{{ block.section.name }}</h2>
          <div class="page-header-actions">
            <a href="{% url 'library:section_item_create' block.section.pk %}" class="btn btn-pill btn-pill-primary">
              {% trans "+ –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–µ–¥–º–µ—Ç" %}
            </a>
          </div>
        </div>
        <div class="collection-grid" style="margin-top:0.8rem;">
          {% for item in block.items %}
            <article class="collection-card">
              <div class="post-menu item-card-menu">
                <button type="button" class="post-menu-btn" data-menu-btn aria-label="Menu">‚Ä¶</button>
                <div class="post-menu-dropdown" data-menu-dropdown hidden>
                  <a class="post-menu-item" href="{% url 'library:item_edit' item.pk %}?next={{ request.get_full_path|urlencode }}">{% trans "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å" %}</a>
                  <button type="button"
                          class="post-menu-item"
                          data-item-move-btn
                          data-move-url="{% url 'library:item_move' item.pk %}">
                    {% trans "–ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –≤ –¥—Ä—É–≥–æ–π —Ä–∞–∑–¥–µ–ª" %}
                  </button>
                  <a class="post-menu-item post-menu-danger"
                     href="{% url 'library:item_delete' item.pk %}"
                     onclick="return confirm(&quot;{{ confirm_delete_item|escapejs }}&quot;)">
                    {% trans "–£–¥–∞–ª–∏—Ç—å" %}
                  </a>
                </div>
              </div>
              <div class="post-carousel item-card-carousel" data-carousel>
                <div class="post-carousel-viewport">
                  <div class="post-carousel-track">
                    {% for m in item.media.all %}
                      <div class="post-carousel-slide">
                        <a href="{{ m.file.url }}" data-gallery-item data-gallery-group="item-{{ item.id }}" data-fullsrc="{{ m.file.url }}">
                          <img class="post-carousel-img" src="{{ m.file.url }}" alt="{{ item.title }}">
                        </a>
                      </div>
                    {% endfor %}
                  </div>
                </div>
                <button type="button" class="post-carousel-nav post-carousel-prev" data-carousel-prev aria-label="Prev">‚Äπ</button>
                <button type="button" class="post-carousel-nav post-carousel-next" data-carousel-next aria-label="Next">‚Ä∫</button>
                <div class="post-carousel-dots" data-carousel-dots>
                  {% for m in item.media.all %}
                    <button type="button" class="post-carousel-dot" data-carousel-dot data-index="{{ forloop.counter0 }}" aria-label="Slide {{ forloop.counter }}"></button>
                  {% endfor %}
                </div>
              </div>
              <h3 style="margin-bottom:0.2rem;">
                <a href="{% url 'library:item_detail' item.pk %}" style="text-decoration:none; color:inherit;">
                  {{ item.title }}
                </a>
              </h3>
              {% if item.description %}
                {% if item.description|length > 220 %}
                  <div class="post-text post-text-compact">
                    <div class="post-text-short">{{ item.description|slice:":220"|linebreaksbr }}‚Ä¶</div>
                    <div class="post-text-full" hidden>{{ item.description|linebreaksbr }}</div>
                    <button type="button" class="post-text-toggle" data-post-text-toggle>{% trans "–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å" %}</button>
                  </div>
                {% else %}
                  <div class="post-text post-text-compact">{{ item.description|linebreaksbr }}</div>
                {% endif %}
              {% endif %}
              <div class="item-card-date">
                {% trans "–î–æ–±–∞–≤–ª–µ–Ω–æ" %}: {{ item.created_at|date:"d.m.Y" }}
              </div>
            </article>
          {% empty %}
            <p style="color:#6b7280;">{% trans "–ü–æ–∫–∞ –Ω–µ—Ç –ø—Ä–µ–¥–º–µ—Ç–æ–≤." %}</p>
          {% endfor %}
        </div>
      </section>
    {% endfor %}
  </div>
{% endif %}

<div class="item-move-modal" id="item-move-modal" hidden>
  <div class="item-move-backdrop" data-item-move-close></div>
  <div class="item-move-dialog" role="dialog" aria-modal="true">
    <div class="item-move-head">
      <div class="item-move-title">{% trans "–ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –ø—Ä–µ–¥–º–µ—Ç" %}</div>
      <button type="button" class="btn btn-icon" data-item-move-close aria-label="{% trans '–ó–∞–∫—Ä—ã—Ç—å' %}">‚úï</button>
    </div>
    <form method="post" id="item-move-form">
      {% csrf_token %}
      <input type="hidden" name="next" value="{{ request.get_full_path|default:'' }}">
      <label for="item-move-section" style="font-weight:700;">{% trans "–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑–¥–µ–ª" %}</label>
      <select name="section_id" id="item-move-section" class="item-move-select" required>
        {% for s in sections %}
          <option value="{{ s.id }}">{{ s.name }}</option>
        {% endfor %}
      </select>
      <div class="item-move-actions">
        <button type="button" class="btn btn-pill btn-pill-ghost" data-item-move-close>{% trans "–û—Ç–º–µ–Ω–∞" %}</button>
        <button type="submit" class="btn btn-pill btn-pill-primary">{% trans "–ü–µ—Ä–µ–Ω–µ—Å—Ç–∏" %}</button>
      </div>
    </form>
  </div>
</div>
{% endblock %}

{% block extra_js %}
  {{ block.super }}
  <script src="{% static 'js/library.js' %}?v=20260129"></script>
{% endblock %}

 
=======
<div class="collection-grid" style="margin-top:0.8rem;">
  {% for item in items %}
    <article class="collection-card">
      <div class="item-card-image">
        {% with primary=item.media.all.0 %}
          {% if primary %}
            <img src="{{ primary.file.url }}" alt="{{ item.title }}">
          {% endif %}
        {% endwith %}
      </div>
      <h3>{{ item.title }}</h3>
      <p>{{ item.description|truncatewords:15 }}</p>
    </article>
  {% empty %}
    <p>{% trans "–ù–µ—Ç –ø—Ä–µ–¥–º–µ—Ç–æ–≤ –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ." %}</p>
  {% endfor %}
</div>
{% include "base/_pagination.html" with page_obj=page_obj %}
<div style="margin-top:1rem;">
  <a href="{% url 'library:collection_create' %}" class="btn btn-primary">
    {% trans "–°–æ–∑–¥–∞—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏—é" %}
  </a>
</div>
{% endblock %}






>>>>>>> c3b89d27ec563af11f9e50443796471accc02753
