{% extends "base/base_app.html" %}
{% load i18n %}

{% block title %}{% trans "–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞" %}{% endblock %}

{% block app_content %}
<form method="get" class="library-filters">
  <div class="page-header">
    <div></div>
    <div class="page-header-actions">
      <button type="button" class="search-icon-button" id="library-search-toggle">
        üîç
      </button>
      <div class="library-search-input-row" id="library-search-row">
        <button type="button" class="search-back" id="library-search-back">‚Üê</button>
        <input
          type="search"
          name="q"
          value="{{ query }}"
          class="search-input"
          placeholder="{% trans '–ü–æ–∏—Å–∫ –ø–æ –∫–æ–ª–ª–µ–∫—Ü–∏–∏' %}"
        >
        <button type="button" class="search-clear" id="library-search-clear">‚úï</button>
        <label class="advanced-toggle">
          <input type="checkbox" name="advanced" {% if advanced %}checked{% endif %}>
          {% trans "–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π" %}
        </label>
      </div>
      <select name="order" class="order-select search-extra">
        <option value="recent" {% if current_order == 'recent' %}selected{% endif %}>{% trans "–ù–µ–¥–∞–≤–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ" %}</option>
        <option value="oldest" {% if current_order == 'oldest' %}selected{% endif %}>{% trans "–î–∞–≤–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ" %}</option>
        <option value="az" {% if current_order == 'az' %}selected{% endif %}>{% trans "–û—Ç –ê –¥–æ –Ø" %}</option>
        <option value="za" {% if current_order == 'za' %}selected{% endif %}>{% trans "–û—Ç –Ø –¥–æ –ê" %}</option>
      </select>
    </div>
  </div>

  <div class="advanced-panel {% if not advanced %}advanced-hidden{% endif %}">
    <label>
      <input type="checkbox" name="search_in_description" {% if request.GET.search_in_description == 'on' %}checked{% endif %}>
      {% trans "–ò—Å–∫–∞—Ç—å —Ç–æ–ª—å–∫–æ –≤ –æ–ø–∏—Å–∞–Ω–∏–∏" %}
    </label>
  </div>

  <div class="pill-filters">
    {% for section in sections %}
      <label class="pill">
        <input
          type="checkbox"
          name="sections"
          value="{{ section.id }}"
          {% if section.id in selected_sections %}checked{% endif %}
        >
        {{ section.name }}
      </label>
    {% empty %}
      <span>{% trans "–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç —Ä–∞–∑–¥–µ–ª–æ–≤. –°–æ–∑–¥–∞–π—Ç–µ –∏—Ö –≤ –∞–¥–º–∏–Ω–∫–µ." %}</span>
    {% endfor %}
  </div>

</form>

<div class="collection-grid" style="margin-top:0.8rem;">
  {% for item in items %}
    <article class="collection-card">
      <div class="item-card-image">
        {% with primary=item.media.all.0 %}
          {% if primary %}
            <img src="{{ primary.file.url }}" alt="{{ item.title }}">
          {% endif %}
        {% endwith %}
      </div>
      <h3>{{ item.title }}</h3>
      <p>{{ item.description|truncatewords:15 }}</p>
    </article>
  {% empty %}
    <p>{% trans "–ù–µ—Ç –ø—Ä–µ–¥–º–µ—Ç–æ–≤ –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ." %}</p>
  {% endfor %}
</div>
{% include "base/_pagination.html" with page_obj=page_obj %}
<div style="margin-top:1rem;">
  <a href="{% url 'library:collection_create' %}" class="btn btn-primary">
    {% trans "–°–æ–∑–¥–∞—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏—é" %}
  </a>
</div>
{% endblock %}






